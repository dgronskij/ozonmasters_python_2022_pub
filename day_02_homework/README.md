# day_02_dz

[TOC]

# UPDATES

- 2022-02-26: Fixed typos in task 1
- 2022-02-23: Fixes for tests 5 and 8

# ETA

| Старт задания          | Решения принимаются до |
| ---------------------- | ---------------------- |
| 2022-02-21 23:59 (Mon) | 2022-03-07 23:59 (Mon) | 

Вам созданы личные проекты в группе python_2_2022/<user>
У вас там есть права Developer -- это значит, что вы можете пушить в незащищенные ветки.
Ветка `main/master` -- защищенная, поэтому ведите работу в какой-то другой, например, `dev`


В качестве решения принимается Merge Request из вашей рабочей ветки в `main/master` вашей личной репы.

Так мы увидим единый diff вашего решения.

Может получиться так, что какая-то задача сделана не совсем верно.

В этом случае мы предложим в процессе ревью исправить решение.


# 00 -- Разбаловка

Задание может быть

- НЕ сдано
- Сдано по базовому треку
    - Должны быть решены
        - все обязательные задания
        - 5 заданий из группы `A`
- Сдано по усложненному треку
    - Должны быть решены
        - все обязательные задания
        - 5 задания из группы `A`
        - 2 задания из группы `B`



| Секция / задача  | Базовый трек | Усложненный трек |
|------------------|--------------|------------------|
| Окружение        | обязательно  | обязательно      |
| gitignore        | обязательно  | обязательно      |
| Gitlab CI        | обязательно  | обязательно      |
| short/task_01.py | обязательно  | обязательно      |
| short/task_02.py | A            | A                |
| short/task_03.py |              | B                |
| short/task_04.py | A            | A                |
| short/task_05.py | A            | A                |
| short/task_06.py | A            | A                |
| short/task_07.py | A            | A                |
| short/task_08.py |              | B                |
| short/task_09.py |              | B                |
| short/task_10.py | A            | A                |


# 01 -- Окружение

1. Создайте новое виртуальное окружение, активируйте его, установите пакет `pytest`
    - `pip install pytest`
    - Этот пакет нужен для помощи в написании задания
2. Выполните `pip freeze > ./requirements.lock.txt`



3. Запустите `pytest .`
4. `pytest` должен запустить, но тесты не проходят -- они будут ваи помогать понять, что еще не сделано

## Доп. вопросы
- **В чем смысл фриза окружения?**
    - Ответ:
- **Допустим, репозиторием пользуется множество людей. Как сделать так, чтобы у всех было одинаковое окружение?**
    - Ответ:

# 02 -- .gitignore

1. Выполните `git status`

У вас должно быть что-то типа такого:

```On branch main
Your branch is up to date with 'origin/main'.

Untracked files:
  (use "git add <file>..." to include in what will be committed)

	__pycache__/
	short/__pycache__/

no changes added to commit (use "git add" and/or "git commit -a")
```

2. Обратите внимание, что появились директории `__pycache__`, которые не должны попадать в комиты.
Нужно всегда следить за тем, что именно вы комитите, поэтому перед каждым комитом надо делать `git status` и `git diff --cached`, чтобы понять, что туда попадет при следуещем `git commit`.

3. Чтобы директории `__pycache__` точно не попала в комиты, надо добавить ее в `.gitignore`
4. [Прочитайте про .gitignore](https://docs.github.com/en/get-started/getting-started-with-git/ignoring-files)
5. Возьмите рекомендуемый шаблон для .gitignore для Python проектов [отсюда](https://github.com/github/gitignore)
6. Добавьте .gitignore в индекс, закомитьте. Сообщение в комите должно отражать суть, например `git commit -m "add .gitignore"`
7. Убедитесь, что директории `__pycache__` пропали из листинга Untracked files и попали в Ignored files в выхлопе команды `git status --ignored`


# 03 -- Gitlab CI

- Определите в .gitlab-ci.yml job c названием .base
    - Которая использует Образ python3.8
    - Устанавливает пакеты из requirements.lock.txt
    - Воспользуйтесь секцией [before_script](https://docs.gitlab.com/ee/ci/yaml/)
- Определите job c названием `test`
    - Которая наследуется от `.base`
    - Вызывает `pytest --tb=short`


Добавьте в индекс и закомитьте .gitlab-ci.yml c понятным сообщением

Убедитесь, что теперь тесты бегут в CI

## Доп. вопросы
- **Почему мы воспользовались секцией before_script в .base джобе?**
    - Ответ:


# 04 -- Задачи

В директории `short` расположены файлы `task_**.py`, в которых смормулированы задания и вопросы, на которые надо ответить.
Задания выполняйте прямо в этих файлах.
Отвечайте на вопрос прямо в тексте вопроса, добавив слово `ответ:` -- так вы скажете тестам, что не надо больше напоминать про этот вопрос

1. Запустите еще раз команду `pytest ./short`
2. Вы увидите список того, что нужно доделать

Чтобы проверить тесты конкретной задачи, запустите `pytest ./short -k <номер задачи>`, где номер задачи -- 01,02,03 и т.д.
